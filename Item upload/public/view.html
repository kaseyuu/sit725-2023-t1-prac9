<!DOCTYPE html>
<html>
  <head>
    <title>View Item</title>
    <style>
      body {
        text-align: center;
      }

      h1 {
        margin-top: 20px;
      }

      .item-details {
        display: inline-block;
        margin-top: 20px;
        text-align: left;
        border: 1px solid #ddd;
        padding: 20px;
      }

      .item-details img {
        max-width: 200px;
        max-height: 200px;
        margin-bottom: 10px;
      }

      .action-buttons {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <h1>View Item</h1>

    <div class="item-details">
      <img src="" alt="Item Image">
      <p><strong>Name:</strong> <span id="name"></span></p>
      <p><strong>Category:</strong> <span id="category"></span></p>
      <p><strong>Subcategory:</strong> <span id="subcategory"></span></p>
      <p><strong>Condition:</strong> <span id="condition"></span></p>
      <p><strong>Price:</strong> <span id="price"></span></p>
      <p><strong>Size:</strong> <span id="size"></span></p>
      <p><strong>Location:</strong> <span id="location"></span></p>
    </div>

    <div class="action-buttons">
      <button id="editButton">Edit</button>
      <button id="deleteButton">Delete</button>
    </div>

    <script>
      // Fetch item details and populate the view
      const itemId = window.location.pathname.split('/').pop();

      fetch(`/items/${itemId}`)
        .then((response) => response.json())
        .then((item) => {
          const name = document.getElementById('name');
          const category = document.getElementById('category');
          const subcategory = document.getElementById('subcategory');
          const condition = document.getElementById('condition');
          const price = document.getElementById('price');
          const size = document.getElementById('size');
          const location = document.getElementById('location');

          const image = document.querySelector('.item-details img');
          image.src = `/uploads/${item.image}`;

          category.textContent = item.name;
          category.textContent = item.category;
          subcategory.textContent = item.subcategory;
          condition.textContent = item.condition;
          price.textContent = item.price;
          size.textContent = item.size;
          location.textContent = item.location;

          const editButton = document.getElementById('editButton');
          editButton.addEventListener('click', () => {
            window.location.href = `/edit/${itemId}`;
          });

          const deleteButton = document.getElementById('deleteButton');
          deleteButton.addEventListener('click', () => {
            if (confirm('Are you sure you want to delete this item?')) {
              fetch(`/items/${itemId}`, { method: 'DELETE' })
                .then(() => {
                  alert('Item deleted successfully');
                  window.location.href = '/items.html';
                })
                .catch((error) =>
                  console.error('Error deleting item:', error)
                );
            }
          });
        })
        .catch((error) => console.error('Error fetching item details:', error));
    </script>
  </body>
</html>
