<!DOCTYPE html>
<html>
  <head>
    <title>Items</title>
    <style>
      body {
        text-align: center;
      }

      table {
        margin: 20px auto;
        border-collapse: collapse;
      }

      th,
      td {
        padding: 8px;
        border: 1px solid #ddd;
      }

      th {
        background-color: #f2f2f2;
        font-weight: bold;
      }

      td img {
        max-width: 100px;
        max-height: 100px;
      }

      .button-container {
        margin: 20px;
      }

      .button-container button {
        padding: 5px 10px;
        margin: 5px;
      }
    </style>
  </head>
  <body>
    <h1>Items</h1>
    <table>
      <tr>
        <th>Name</th>
        <th>Category</th>
        <th>Subcategory</th>
        <th>Condition</th>
        <th>Price</th>
        <th>Size</th>
        <th>Location</th>
        <th>Image</th>
        <th>Actions</th>
      </tr>
    </table>

    <div class="button-container">
      <button onclick="window.location.href = '/'">Add Item</button>
    </div>

  <script>
  // Fetch and display items
  fetch('/items')
    .then((response) => response.json())
    .then((items) => {
      const table = document.querySelector('table');

      items.forEach((item) => {
        const row = table.insertRow();

        row.insertCell().textContent = item.name;
        row.insertCell().textContent = item.category;
        row.insertCell().textContent = item.subcategory;
        row.insertCell().textContent = item.condition;
        row.insertCell().textContent = item.price;
        row.insertCell().textContent = item.size;
        row.insertCell().textContent = item.location;

        const imageCell = row.insertCell();
        const image = document.createElement('img');
        image.src = `/uploads/${item.image}`;
        imageCell.appendChild(image);

        const actionsCell = row.insertCell();
        const editButton = document.createElement('button');
        editButton.textContent = 'Edit';
        editButton.addEventListener('click', () => {
          window.location.href = `/edit/${item._id}`;
        });
        actionsCell.appendChild(editButton);

        const deleteButton = document.createElement('button');
        deleteButton.textContent = 'Delete';
        deleteButton.addEventListener('click', () => {
          deleteItem(item._id);
        });
        actionsCell.appendChild(deleteButton);

        const viewButton = document.createElement('button');
        viewButton.textContent = 'View';
        viewButton.addEventListener('click', () => {
         window.location.href = `/item/${item._id}`;
        });
        actionsCell.appendChild(viewButton);
      });
    })
    .catch((error) => console.error('Error fetching items:', error));

  // Delete an item
  function deleteItem(itemId) {
    if (confirm('Are you sure you want to delete this item?')) {
      fetch(`/items/${itemId}`, { method: 'DELETE' })
        .then((response) => response.json())
        .then((data) => {
          alert(data.message);
          window.location.reload();
        })
        .catch((error) => console.error('Error deleting item:', error));
    }
  }
</script>
  </body>
</html>
